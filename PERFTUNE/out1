Expanded display is on.
(0 rows)

(0 rows)

-[ RECORD 1 ]-----------------------------------------------------------------------
runtime | 00:00:00
datname | fly1
usename | master
query   | select current_timestamp - query_start as runtime, datname, usename, query+
        |     from pg_stat_activity                                                 +
        |     where state != 'idle'                                                 +
        |     order by 1 desc;

-[ RECORD 1 ]------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
total | 0.222338919816667
avg   | 1.7171238497876202
query | insert into orders (ORDER_DATETIME,CUSTOMER_ID,STORE_ID,ORDER_STATUS)                                                                                                                                                                                                                                                                                                                                                                                                                                                  +
      | values                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 +
      | (now(),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                +
      | (    select customer_id from customers offset random() * (select count(*) from customers) limit $1 ),                                                                                                                                                                                                                                                                                                                                                                                                                  +
      | (    select store_id from stores offset random() * (select count(*) from stores) limit $2 ),                                                                                                                                                                                                                                                                                                                                                                                                                           +
      | (    select order_status from orders offset random() * (select count(*) from orders) limit $3 )                                                                                                                                                                                                                                                                                                                                                                                                                        +
      | )
-[ RECORD 2 ]------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
total | 0.13197320756666645
avg   | 0.4497553364762006
query | SELECT * FROM (SELECT * FROM orders ORDER BY order_datetime DESC LIMIT $1) a ORDER BY order_datetime ASC
-[ RECORD 3 ]------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
total | 0.08477792570000005
avg   | 0.27705204477124196
query | select count(*) from orders
-[ RECORD 4 ]------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
total | 0.026924764883333334
avg   | 10.160288635220127
query | select sum(numbackends) numbackends, sum(xact_commit) xact_commit, sum(xact_rollback) xact_rollback, sum(blks_read) blks_read, sum(blks_hit) blks_hit, sum(tup_returned) tup_returned, sum(tup_fetched) tup_fetched, sum(tup_inserted) tup_inserted, sum(tup_updated) tup_updated, sum(tup_deleted) tup_deleted, sum(conflicts) conflicts, sum(temp_files) temp_files, sum(temp_bytes) temp_bytes, sum(deadlocks) deadlocks, sum(blk_read_time) blk_read_time, sum(blk_write_time) blk_write_time from pg_stat_database
-[ RECORD 5 ]------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
total | 0.015314552349999995
avg   | 1.552150576013513
query | SELECT                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 +
      |   COALESCE(l1.relation::regclass::text,l1.locktype) as locked_item,                                                                                                                                                                                                                                                                                                                                                                                                                                                    +
      |   w.wait_event_type as waiting_ev_type, w.wait_event as waiting_ev, w.query as waiting_query,                                                                                                                                                                                                                                                                                                                                                                                                                          +
      |   l1.mode as waiting_mode,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             +
      |   (select now() - xact_start as waiting_xact_duration from pg_stat_activity where pid = w.pid),                                                                                                                                                                                                                                                                                                                                                                                                                        +
      |   (select now() - query_start as waiting_query_duration from pg_stat_activity where pid = w.pid),                                                                                                                                                                                                                                                                                                                                                                                                                      +
      |   w.pid as waiting_pid, w.usename as waiting_user, w.state as waiting_state,                                                                                                                                                                                                                                                                                                                                                                                                                                           +
      |   l.wait_event_type as locking_ev_type, l.wait_event_type as locking_ev, l.query as locking_query,                                                                                                                                                                                                                                                                                                                                                                                                                     +
      |   l2.mode as locking_mode,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             +
      |   (select now() - xact_start as locking_xact_duration from pg_stat_activity where pid = l.pid),                                                                                                                                                                                                                                                                                                                                                                                                                        +
      |   (select now() - query_start as locking_query_duration from pg_stat_activity where pid = l.pid),                                                                                                                                                                                                                                                                                                                                                                                                                      +
      |   l.pid as locking_pid, l.usename as locking_user, l.state as locking_state                                                                                                                                                                                                                                                                                                                                                                                                                                            +
      | FROM pg_stat_activity w                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                +
      | JOIN pg_locks l1 ON w.pid = l1.pid AND NOT l1.granted                                                                                                                                                                                                                                                                                                                                                                                                                                                                  +
      | JOIN pg_locks l2 ON (l1.transactionid = l2.transactionid AND l1.pid != l2.pid)                                                                                                                                                                                                                                                                                                                                                                                                                                         +
      |     OR (l1.database = l2.database AND l1.relation = l2.relation and l1.pid != l2.pid)                                                                                                                                                                                                                                                                                                                                                                                                                                  +
      | JOIN pg_stat_activity l ON l2.pid = l.pid                                                                                                                                                                                                                                                                                                                                                                                                                                                                              +
      | WHERE w.wait_event is not null and w.wait_event_type is not null                                                                                                                                                                                                                                                                                                                                                                                                                                                       +
      | ORDER BY l.query_start,w.query_start
-[ RECORD 6 ]------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
total | 0.015036365183333315
avg   | 0.09506658703898829
query | select pid, usename, client_addr, client_hostname, wait_event_type, wait_event, query, datname, application_name, backend_type from pg_stat_activity where state = $1
-[ RECORD 7 ]------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
total | 0.008006715833333341
avg   | 0.4375254553734066
query | SELECT n.nspname as "Schema",                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          +
      |   c.relname as "Name",                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 +
      |   CASE c.relkind WHEN $1 THEN $2 WHEN $3 THEN $4 WHEN $5 THEN $6 WHEN $7 THEN $8 WHEN $9 THEN $10 WHEN $11 THEN $12 WHEN $13 THEN $14 WHEN $15 THEN $16 WHEN $17 THEN $18 END as "Type",                                                                                                                                                                                                                                                                                                                               +
      |   pg_catalog.pg_get_userbyid(c.relowner) as "Owner"                                                                                                                                                                                                                                                                                                                                                                                                                                                                    +
      | FROM pg_catalog.pg_class c                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             +
      |      LEFT JOIN pg_catalog.pg_namespace n ON n.oid = c.relnamespace                                                                                                                                                                                                                                                                                                                                                                                                                                                     +
      | WHERE c.relkind IN ($19,$20,$21)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       +
      |       AND n.nspname <> $22                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             +
      |       AND n.nspname <> $23                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             +
      |       AND n.nspname !~ $24                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             +
      |   AND pg_catalog.pg_table_is_visible(c.oid)                                                                                                                                                                                                                                                                                                                                                                                                                                                                            +
      | ORDER BY 1,2
-[ RECORD 8 ]------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
total | 0.001954069783333333
avg   | 0.7373848238993711
query | select count(distinct transactionid::varchar) active_transactions from pg_locks where locktype = $1
-[ RECORD 9 ]------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
total | 0.0019102035333333329
avg   | 0.7208315220125784
query | select count(distinct pid) blocked_transactions from pg_locks where not granted
-[ RECORD 10 ]-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
total | 0.0017447637833333334
avg   | 10.4685827
query | SELECT * FROM pg_stat_user_tables

-[ RECORD 1 ]------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
query       | insert into orders (ORDER_DATETIME,CUSTOMER_ID,STORE_ID,ORDER_STATUS)                                                                                                                                                                                                                                                                                                                                                                                                                                                  +
            | values                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 +
            | (now(),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                +
            | (    select customer_id from customers offset random() * (select count(*) from customers) limit $1 ),                                                                                                                                                                                                                                                                                                                                                                                                                  +
            | (    select store_id from stores offset random() * (select count(*) from stores) limit $2 ),                                                                                                                                                                                                                                                                                                                                                                                                                           +
            | (    select order_status from orders offset random() * (select count(*) from orders) limit $3 )                                                                                                                                                                                                                                                                                                                                                                                                                        +
            | )
calls       | 7769
total_time  | 13340.335189000021
rows        | 7769
hit_percent | 99.9956479259102907
-[ RECORD 2 ]------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
query       | SELECT * FROM (SELECT * FROM orders ORDER BY order_datetime DESC LIMIT $1) a ORDER BY order_datetime ASC
calls       | 17606
total_time  | 7918.392453999987
rows        | 88030
hit_percent | 100.0000000000000000
-[ RECORD 3 ]------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
query       | select count(*) from orders
calls       | 18360
total_time  | 5086.675542000003
rows        | 18360
hit_percent | 100.0000000000000000
-[ RECORD 4 ]------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
query       | select sum(numbackends) numbackends, sum(xact_commit) xact_commit, sum(xact_rollback) xact_rollback, sum(blks_read) blks_read, sum(blks_hit) blks_hit, sum(tup_returned) tup_returned, sum(tup_fetched) tup_fetched, sum(tup_inserted) tup_inserted, sum(tup_updated) tup_updated, sum(tup_deleted) tup_deleted, sum(conflicts) conflicts, sum(temp_files) temp_files, sum(temp_bytes) temp_bytes, sum(deadlocks) deadlocks, sum(blk_read_time) blk_read_time, sum(blk_write_time) blk_write_time from pg_stat_database
calls       | 159
total_time  | 1615.485893
rows        | 159
hit_percent | 100.0000000000000000
-[ RECORD 5 ]------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
query       | SELECT                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 +
            |   COALESCE(l1.relation::regclass::text,l1.locktype) as locked_item,                                                                                                                                                                                                                                                                                                                                                                                                                                                    +
            |   w.wait_event_type as waiting_ev_type, w.wait_event as waiting_ev, w.query as waiting_query,                                                                                                                                                                                                                                                                                                                                                                                                                          +
            |   l1.mode as waiting_mode,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             +
            |   (select now() - xact_start as waiting_xact_duration from pg_stat_activity where pid = w.pid),                                                                                                                                                                                                                                                                                                                                                                                                                        +
            |   (select now() - query_start as waiting_query_duration from pg_stat_activity where pid = w.pid),                                                                                                                                                                                                                                                                                                                                                                                                                      +
            |   w.pid as waiting_pid, w.usename as waiting_user, w.state as waiting_state,                                                                                                                                                                                                                                                                                                                                                                                                                                           +
            |   l.wait_event_type as locking_ev_type, l.wait_event_type as locking_ev, l.query as locking_query,                                                                                                                                                                                                                                                                                                                                                                                                                     +
            |   l2.mode as locking_mode,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             +
            |   (select now() - xact_start as locking_xact_duration from pg_stat_activity where pid = l.pid),                                                                                                                                                                                                                                                                                                                                                                                                                        +
            |   (select now() - query_start as locking_query_duration from pg_stat_activity where pid = l.pid),                                                                                                                                                                                                                                                                                                                                                                                                                      +
            |   l.pid as locking_pid, l.usename as locking_user, l.state as locking_state                                                                                                                                                                                                                                                                                                                                                                                                                                            +
            | FROM pg_stat_activity w                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                +
            | JOIN pg_locks l1 ON w.pid = l1.pid AND NOT l1.granted                                                                                                                                                                                                                                                                                                                                                                                                                                                                  +
            | JOIN pg_locks l2 ON (l1.transactionid = l2.transactionid AND l1.pid != l2.pid)                                                                                                                                                                                                                                                                                                                                                                                                                                         +
            |     OR (l1.database = l2.database AND l1.relation = l2.relation and l1.pid != l2.pid)                                                                                                                                                                                                                                                                                                                                                                                                                                  +
            | JOIN pg_stat_activity l ON l2.pid = l.pid                                                                                                                                                                                                                                                                                                                                                                                                                                                                              +
            | WHERE w.wait_event is not null and w.wait_event_type is not null                                                                                                                                                                                                                                                                                                                                                                                                                                                       +
            | ORDER BY l.query_start,w.query_start
calls       | 592
total_time  | 918.8731409999997
rows        | 0
hit_percent | 100.0000000000000000

